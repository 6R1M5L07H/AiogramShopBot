# ============================================================================
# AiogramShopBot Configuration Template
# ============================================================================
#
# HOW TO USE:
# 1. Copy this file: cp .env.template .env
# 2. Fill in all values (replace empty strings and placeholders)
# 3. Never commit .env to git (it's in .gitignore)
#
# ENVIRONMENT-SPECIFIC TEMPLATES:
# For optimized configurations, use environment-specific templates instead:
#
#   Development:  cp .env.dev.template .env
#   Production:   cp .env.prod.template .env
#
# These templates have pre-configured defaults optimized for their respective
# environments (dev: relaxed limits, debug logging; prod: strict security).
#
# This universal template includes detailed documentation for all settings
# but requires manual configuration of all values.
#
# ============================================================================

# ----------------------------------------------------------------------------
# TELEGRAM BOT CONFIGURATION
# ----------------------------------------------------------------------------

# Bot API token from @BotFather
# Example: 1234567890:ABCdefGHIjklMNOpqrsTUVwxyz1234567890
TOKEN=

# Comma-separated list of Telegram user IDs with admin privileges
# Find your ID via @userinfobot
# Example: 123456789,987654321
#
#  WARNING: SECURITY CONSIDERATION:
# Admin IDs must be in plaintext for the system to send notifications
# (new orders, errors, system events). The system generates hashes
# at runtime for permission checks.
#
# SECURITY BEST PRACTICES:
# - Set file permissions: chmod 600 .env (owner read/write only)
# - Never commit .env to version control (already in .gitignore)
# - Use secrets management in production (Vault, AWS Secrets Manager)
# - Rotate IDs immediately if .env file is compromised
ADMIN_ID_LIST=

# Support contact link shown to users (Telegram username or group)
# Example: https://t.me/your_username
SUPPORT_LINK=

# ----------------------------------------------------------------------------
# WEBHOOK CONFIGURATION
# ----------------------------------------------------------------------------

# Webhook path for Telegram updates (usually "/")
WEBHOOK_PATH=/

# Host address for the web application
# Production: Use your domain or server IP
# Development: Use "localhost" or "0.0.0.0"
WEBAPP_HOST=localhost

# Port for the web application
# Must be available and not blocked by firewall
WEBAPP_PORT=5001

# Secret token for webhook authentication (generate random string)
# Used to verify requests are from Telegram
# Example: dev-webhook-secret-12345
WEBHOOK_SECRET_TOKEN=

# ----------------------------------------------------------------------------
# RUNTIME ENVIRONMENT
# ----------------------------------------------------------------------------

# Runtime environment mode
# Options: DEV (development with ngrok) | PROD (production)
# DEV: Uses ngrok tunnel for local development
# PROD: Uses external IP from sslipio
RUNTIME_ENVIRONMENT=DEV

# Ngrok authentication token (only needed for DEV mode)
# Get from https://dashboard.ngrok.com/get-started/your-authtoken
# Leave empty if RUNTIME_ENVIRONMENT=PROD
NGROK_TOKEN=

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

# SQLite database filename
# Example: database.db
DB_NAME=database.db

# Database encryption (experimental feature)
# Options: true | false
# Note: May impact performance
DB_ENCRYPTION=false

# Database password (used if DB_ENCRYPTION=true)
# Example: your-secure-password-123
DB_PASS=

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------

# Redis server hostname
# Local: localhost
# Docker: redis (service name)
# Production: Your Redis server address
REDIS_HOST=localhost

# Redis authentication password
# Leave empty if Redis has no password
# Example: your-redis-password-123
REDIS_PASSWORD=

# ----------------------------------------------------------------------------
# BOT BEHAVIOR CONFIGURATION
# ----------------------------------------------------------------------------

# Number of items per page in paginated lists
# Recommended: 5-10 for optimal UX
PAGE_ENTRIES=8

# Bot language for localization
# Options: en (English) | de (German)
BOT_LANGUAGE=en

# Multi-bot mode (allows multiple bot instances)
# Options: true | false
# Set to false for single-bot deployments
MULTIBOT=false

# Fiat currency for prices
# Options: USD | EUR | GBP
CURRENCY=USD

# ----------------------------------------------------------------------------
# PAYMENT SYSTEM (KryptoExpress)
# ----------------------------------------------------------------------------

# KryptoExpress API Key
# Get from your KryptoExpress dashboard
KRYPTO_EXPRESS_API_KEY=

# KryptoExpress API URL
# Production: https://kryptoexpress.pro/api
# Staging: Check KryptoExpress docs
KRYPTO_EXPRESS_API_URL=https://kryptoexpress.pro/api

# KryptoExpress API Secret for webhook verification (HMAC-SHA512)
# IMPORTANT: This is NOT provided by KryptoExpress - YOU generate it yourself!
#
# How to generate:
#   openssl rand -hex 32
#   OR use any random string generator (min 20 characters recommended)
#
# How it works:
#   1. You generate a secret string (e.g., "my-super-secret-key-12345")
#   2. Bot sends this secret to KryptoExpress when creating payments
#   3. KryptoExpress uses YOUR secret to sign webhook callbacks (HMAC-SHA512)
#   4. Bot verifies webhook signatures using the same secret
#   5. This ensures webhooks are actually from KryptoExpress, not attackers
#
# Security: Keep this secret! Anyone with this can forge webhook requests
# Optional: Leave empty to disable signature verification (NOT recommended for production)
#
# Example: abc123def456789012345678901234567890abcdef1234567890abcdef123456
KRYPTO_EXPRESS_API_SECRET=

# ----------------------------------------------------------------------------
# ORDER & INVOICE SYSTEM
# ----------------------------------------------------------------------------

# Order timeout in minutes (how long payment window stays open)
# After timeout: Order cancelled automatically, stock released
# Recommended: 15-30 minutes
# Example: 30
ORDER_TIMEOUT_MINUTES=30

# Grace period for free order cancellation (minutes)
# Within this period: User can cancel without penalty
# After period: Cancellation results in strike
# Recommended: 3-5 minutes
# Example: 5
ORDER_CANCEL_GRACE_PERIOD_MINUTES=5

# Payment status check interval in seconds
# How often the payment timeout job checks for expired orders
# Recommended: 30-60 seconds
# Example: 60
PAYMENT_CHECK_INTERVAL_SECONDS=60

# ----------------------------------------------------------------------------
# PAYMENT VALIDATION SYSTEM
# ----------------------------------------------------------------------------

# Overpayment tolerance percentage
# Payments within this percentage above required are accepted as "exact"
# Excess amount â‰¤ tolerance: Forfeits to shop
# Excess amount > tolerance: Credited to wallet
# Example: 0.1 means 0.1% tolerance
PAYMENT_TOLERANCE_OVERPAYMENT_PERCENT=0.1

# Enable underpayment retry (allow one-time retry with 30 min extension)
# Options: true | false
PAYMENT_UNDERPAYMENT_RETRY_ENABLED=true

# Timeout extension in minutes for underpayment retry (after 1st underpayment)
# Recommended: 30 minutes
PAYMENT_UNDERPAYMENT_RETRY_TIMEOUT_MINUTES=30

# Penalty percentage for second underpayment
# Applied when user fails to pay correct amount twice
# Example: 5 means 5% penalty
PAYMENT_UNDERPAYMENT_PENALTY_PERCENT=5

# Penalty percentage for late payment (after deadline)
# Applied when payment arrives after order expired
# Example: 5 means 5% penalty
PAYMENT_LATE_PENALTY_PERCENT=5

# ----------------------------------------------------------------------------
# CRYPTOCURRENCY DECIMAL PRECISION
# ----------------------------------------------------------------------------
#
# Defines the number of decimal places for each cryptocurrency (smallest unit).
# Critical for preventing floating-point rounding errors in payment validation.
#
# Default values:
#   BTC: 8 decimals = satoshi (1 BTC = 100,000,000 satoshi)
#   LTC: 8 decimals = litoshi (1 LTC = 100,000,000 litoshi)
#   ETH: 18 decimals = wei (1 ETH = 1,000,000,000,000,000,000 wei)
#   SOL: 9 decimals = lamport (1 SOL = 1,000,000,000 lamport)
#   BNB: 18 decimals (1 BNB = 1,000,000,000,000,000,000 smallest units)
#   USDT (TRC20/ERC20): 6 decimals (1 USDT = 1,000,000 smallest units)
#   USDC (ERC20): 6 decimals (1 USDC = 1,000,000 smallest units)
#
#  WARNING: WARNING: Only change these if the blockchain protocol changes!
# Incorrect values will cause payment validation errors.
#
# Leave commented to use defaults (recommended).
# Uncomment only if you need to override for testing or protocol updates.

# CRYPTO_DECIMALS_BTC=8
# CRYPTO_DECIMALS_LTC=8
# CRYPTO_DECIMALS_ETH=18
# CRYPTO_DECIMALS_SOL=9
# CRYPTO_DECIMALS_BNB=18
# CRYPTO_DECIMALS_USDT_TRC20=6
# CRYPTO_DECIMALS_USDT_ERC20=6
# CRYPTO_DECIMALS_USDC_ERC20=6

# ----------------------------------------------------------------------------
# DATA RETENTION & PRIVACY
# ----------------------------------------------------------------------------

# Data retention period in days for orders, invoices, and payment transactions
# After this period: All order-related data is permanently deleted
# Recommended: 30 days (GDPR compliance)
DATA_RETENTION_DAYS=30

# Referral data retention in days (longer than orders for abuse detection)
# Referral usage records kept for pattern analysis
# Recommended: 365 days
REFERRAL_DATA_RETENTION_DAYS=365

# ----------------------------------------------------------------------------
# SHIPPING MANAGEMENT (for physical items)
# ----------------------------------------------------------------------------

# Encryption secret for shipping addresses (AES-256-GCM)
# REQUIRED if you have physical items with shipping
# Used to encrypt customer shipping addresses in database (GDPR compliance)
#
# Generate with:
#   openssl rand -hex 32
#
# Important:
#   - Must be exactly 64 hex characters (32 bytes)
#   - Keep this secret safe - losing it means losing access to all addresses
#   - Never change after addresses are stored (old addresses become unreadable)
#   - Back up this value along with your database
#
# Example: 1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3
ENCRYPTION_SECRET=

# ----------------------------------------------------------------------------
# STRIKE SYSTEM (automated penalty system)
# ----------------------------------------------------------------------------

# Maximum strikes before automatic user ban
# Strikes are given for:
#   - Order timeout (payment not received)
#   - Manual cancellation after grace period
# Recommended: 3 strikes
# Example: 3
MAX_STRIKES_BEFORE_BAN=3

# Exempt admins from automatic bans (for testing)
# Options: true | false
#
# When true:
#   - Admins accumulate strikes normally
#   - Admins can see strike statistics
#   - Admins will NOT be banned when reaching MAX_STRIKES_BEFORE_BAN
#   - Admins can still use the bot after ban threshold
#   - Useful for testing the strike system safely
#
# When false:
#   - Admins are treated exactly like regular users
#   - Admins WILL be banned after MAX_STRIKES_BEFORE_BAN strikes
#   - Admins will be blocked from using bot functions when banned
#   - Use this in production if admins should follow same rules
#
# Recommended: true for testing, false for production
# Example: true
EXEMPT_ADMINS_FROM_BAN=true

# Minimum wallet top-up amount (in EUR) required to unban a user
# Banned users can unban themselves by topping up their wallet with this amount
# After unban:
#   - User is unbanned (is_blocked = false)
#   - Strikes remain unchanged (strike_count stays the same)
#   - One more strike = immediate re-ban (because strike_count >= MAX_STRIKES_BEFORE_BAN)
# Recommended: 50.0 EUR
# Example: 50.0
UNBAN_TOP_UP_AMOUNT=50.0

# ----------------------------------------------------------------------------
# DATABASE BACKUP CONFIGURATION
# ----------------------------------------------------------------------------

# Enable automated database backups
# Options: true | false
#
# When enabled:
#   - Automated backups run at configured intervals
#   - Backups are compressed with gzip
#   - SHA256 checksums created for verification
#   - Old backups cleaned up according to retention policy
#   - Admin notifications on backup failures
#
# Recommended: true for production
# Example: true
DB_BACKUP_ENABLED=true

# Backup interval in hours
# How often to create a new database backup
# Recommended: 6 hours (4 backups per day)
# Example: 6
DB_BACKUP_INTERVAL_HOURS=6

# Backup retention period in days
# How long to keep old backups before deletion
# Recommended: 7 days (provides 1 week of restore points)
# Example: 7
DB_BACKUP_RETENTION_DAYS=7

# Backup directory path
# Where backup files will be stored
# Important: Ensure this directory is:
#   - On a reliable storage system
#   - Backed up separately (external backup)
#   - Has sufficient disk space
#   - Protected with proper permissions (chmod 700)
#
# Recommended: ./backups (relative to project root)
# Production: /var/backups/shopbot or mounted network storage
# Example: ./backups
DB_BACKUP_PATH=./backups

# ----------------------------------------------------------------------------
# WEBHOOK SECURITY CONFIGURATION
# ----------------------------------------------------------------------------
#
# NOTE: Security headers are primarily relevant for browser-based applications.
# For pure API/webhook bots (no web UI), these headers provide minimal benefit.
#
# WHEN TO ENABLE:
#   - Adding web-based admin dashboard
#   - Adding public status pages
#   - Serving HTML content
#
# WHEN TO KEEP DISABLED (current setup):
#   - Pure Telegram bot (only JSON APIs)
#   - Server-to-server webhooks
#   - No browser interaction
#
# More important security measures (already implemented):
#     Secret token validation (WEBHOOK_SECRET_TOKEN)
#     Rate limiting (MAX_ORDERS_PER_USER_PER_HOUR)
#     Input validation (SQLAlchemy ORM, Pydantic)
#     HTTPS/TLS (production)
#     Secret masking in logs

# Enable security headers for webhook endpoints
# Options: true | false
#
# When enabled, adds the following HTTP security headers:
#   - X-Content-Type-Options: nosniff (prevent MIME sniffing)
#   - X-Frame-Options: DENY (prevent clickjacking)
#   - X-XSS-Protection: 1; mode=block (enable browser XSS filter)
#   - Referrer-Policy: no-referrer-when-downgrade
#   - Permissions-Policy: Disable dangerous browser features
#
# Recommended:
#   - false for pure API/webhook bots (default)
#   - true when adding web-based UI
#
# Example: false
WEBHOOK_SECURITY_HEADERS_ENABLED=false

# Enable Content Security Policy (CSP)
# Options: true | false
#
# Adds strict CSP headers to mitigate XSS and injection attacks
# For API/webhook endpoints, uses restrictive policy (default-src 'none')
#
# Recommended:
#   - false for pure API/webhook bots (default)
#   - true when serving HTML content
#
# Example: false
WEBHOOK_CSP_ENABLED=false

# Enable HTTP Strict Transport Security (HSTS)
# Options: true | false
#
# IMPORTANT: Only enable if serving over HTTPS!
# Forces browsers to use HTTPS for all future connections
# max-age: 1 year, includeSubDomains: applies to all subdomains
#
# When enabled:
#   - Strict-Transport-Security: max-age=31536000; includeSubDomains
#
# Recommended:
#   - false for local development (HTTP)
#   - true for production (HTTPS required)
#
# Example: false
WEBHOOK_HSTS_ENABLED=false

# CORS allowed origins (comma-separated)
# Controls which domains can make cross-origin requests to webhooks
#
# Leave empty to disable CORS (recommended for Telegram webhooks)
# For payment webhooks from KryptoExpress, add their domain
#
# Examples:
#   - Empty (no CORS): WEBHOOK_CORS_ALLOWED_ORIGINS=
#   - Single origin: WEBHOOK_CORS_ALLOWED_ORIGINS=https://kryptoexpress.pro
#   - Multiple origins: WEBHOOK_CORS_ALLOWED_ORIGINS=https://example.com,https://api.example.com
#
# Recommended: Empty for Telegram webhooks, specific origins for payment webhooks
# Example: https://kryptoexpress.pro
WEBHOOK_CORS_ALLOWED_ORIGINS=

# ----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------------------------

# Log level for application and SQLAlchemy
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
#
# DEBUG: Shows all logs including SQL queries (verbose, for development)
# INFO: Shows informational messages (recommended for production)
# WARNING: Shows warnings and errors only
# ERROR: Shows errors only
# CRITICAL: Shows only critical errors
#
# When LOG_LEVEL=DEBUG:
#   - All SQL queries are logged
#   - Detailed execution traces
#   - Performance impact (slower)
#
# When LOG_LEVEL=INFO (recommended):
#   - SQL queries are NOT logged
#   - Clean logs for monitoring
#   - Better performance
#
# Default: INFO
LOG_LEVEL=INFO

# Number of days to keep rotated log files
# Logs rotate daily at midnight, old logs are automatically deleted
# Default: 7
# Example: 30 (keep logs for 30 days)
LOG_ROTATION_DAYS=7

# Enable masking of sensitive data in logs (passwords, tokens, addresses)
# Options: true | false
# Recommended: true (always enabled for security)
# Default: true
LOG_MASK_SECRETS=true

